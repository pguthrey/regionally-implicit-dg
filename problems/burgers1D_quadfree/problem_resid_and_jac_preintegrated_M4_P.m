function [Jac_east_cell_temp,Jac_west_cell_temp, Jac_east_other_temp,Jac_west_other_temp, Jac_trunc_east_temp,Jac_trunc_west_temp,Jac_cell,trunc_east_temp,trunc_west_temp,flux_east_temp,flux_west_temp,residual_cell,maxspeedF] = problem_resid_and_jac_preintegrated_M4_P(qstar,qeast,qwest,qpast,data,cellcenter) 
nuv1 = data.nuv1;
maxspeedF = max(max(qwest(1),qstar(1)),qeast(1));
us10= qstar(10);
us9= qstar(9);
us8= qstar(8);
us7= qstar(7);
us6= qstar(6);
us5= qstar(5);
us4= qstar(4);
us3= qstar(3);
us2= qstar(2);
us1= qstar(1);
uw10= qwest(10);
uw9= qwest(9);
uw8= qwest(8);
uw7= qwest(7);
uw6= qwest(6);
uw5= qwest(5);
uw4= qwest(4);
uw3= qwest(3);
uw2= qwest(2);
uw1= qwest(1);
ue10= qeast(10);
ue9= qeast(9);
ue8= qeast(8);
ue7= qeast(7);
ue6= qeast(6);
ue5= qeast(5);
ue4= qeast(4);
ue3= qeast(3);
ue2= qeast(2);
ue1= qeast(1);
Fe10= ue1*ue10 + 0.8783100656536799*ue5*ue8 + 0.8783100656536799*ue6*ue9 + 0.5962847939999439*ue8*ue10;
Fe9= ue1*ue9 + ue2*ue8 + 0.8944271909999159*ue5*ue6 + 0.8944271909999159*ue3*ue9 + 0.8*ue6*ue7 + 0.8783100656536799*ue6*ue10 + 0.6388765649999399*ue8*ue9;
Fe8= ue1*ue8 + ue2*ue9 + 0.8783100656536799*ue5*ue10 + 0.4472135954999579*ue5^2 + 0.4472135954999579*ue6^2 + 0.4472135954999579*ue7^2 + 0.31943828249997*ue8^2 + 0.31943828249997*ue9^2 + 0.298142396999972*ue10^2;
Fe7= ue1*ue7 + 0.8944271909999159*ue2*ue6 + ue3*ue5 + 0.6388765649999399*ue3*ue7 + 0.8783100656536799*ue4*ue6 + 0.8*ue6*ue9 + 0.8944271909999159*ue7*ue8;
Fe6= ue1*ue6 + ue2*ue5 + 0.8944271909999159*ue2*ue7 + 0.8944271909999159*ue3*ue6 + 0.8783100656536799*ue4*ue7 + 0.8944271909999159*ue5*ue9 + 0.8944271909999159*ue6*ue8 + 0.8*ue7*ue9 + 0.8783100656536799*ue9*ue10;
Fe5= ue1*ue5 + ue2*ue6 + ue3*ue7 + 0.8944271909999159*ue5*ue8 + 0.8944271909999159*ue6*ue9 + 0.8783100656536799*ue8*ue10;
Fe4= ue1*ue4 + 0.8783100656536799*ue2*ue3 + 0.5962847939999439*ue3*ue4 + 0.8783100656536799*ue6*ue7;
Fe3= ue1*ue3 + 0.8783100656536799*ue2*ue4 + ue5*ue7 + 0.4472135954999579*ue2^2 + 0.31943828249997*ue3^2 + 0.298142396999972*ue4^2 + 0.4472135954999579*ue6^2 + 0.31943828249997*ue7^2 + 0.4472135954999579*ue9^2;
Fe2= ue1*ue2 + 0.8944271909999159*ue2*ue3 + 0.8783100656536799*ue3*ue4 + ue5*ue6 + 0.8944271909999159*ue6*ue7 + ue8*ue9;
Fe1= 0.5*ue1^2 + 0.5*ue2^2 + 0.5*ue3^2 + 0.5*ue4^2 + 0.5*ue5^2 + 0.5*ue6^2 + 0.5*ue7^2 + 0.5*ue8^2 + 0.5*ue9^2 + 0.5*ue10^2;
Fs10= us1*us10 + 0.8783100656536799*us5*us8 + 0.8783100656536799*us6*us9 + 0.5962847939999439*us8*us10;
Fs9= us1*us9 + us2*us8 + 0.8944271909999159*us5*us6 + 0.8944271909999159*us3*us9 + 0.8*us6*us7 + 0.8783100656536799*us6*us10 + 0.6388765649999399*us8*us9;
Fs8= us1*us8 + us2*us9 + 0.8783100656536799*us5*us10 + 0.4472135954999579*us5^2 + 0.4472135954999579*us6^2 + 0.4472135954999579*us7^2 + 0.31943828249997*us8^2 + 0.31943828249997*us9^2 + 0.298142396999972*us10^2;
Fs7= us1*us7 + 0.8944271909999159*us2*us6 + us3*us5 + 0.6388765649999399*us3*us7 + 0.8783100656536799*us4*us6 + 0.8*us6*us9 + 0.8944271909999159*us7*us8;
Fs6= us1*us6 + us2*us5 + 0.8944271909999159*us2*us7 + 0.8944271909999159*us3*us6 + 0.8783100656536799*us4*us7 + 0.8944271909999159*us5*us9 + 0.8944271909999159*us6*us8 + 0.8*us7*us9 + 0.8783100656536799*us9*us10;
Fs5= us1*us5 + us2*us6 + us3*us7 + 0.8944271909999159*us5*us8 + 0.8944271909999159*us6*us9 + 0.8783100656536799*us8*us10;
Fs4= us1*us4 + 0.8783100656536799*us2*us3 + 0.5962847939999439*us3*us4 + 0.8783100656536799*us6*us7;
Fs3= us1*us3 + 0.8783100656536799*us2*us4 + us5*us7 + 0.4472135954999579*us2^2 + 0.31943828249997*us3^2 + 0.298142396999972*us4^2 + 0.4472135954999579*us6^2 + 0.31943828249997*us7^2 + 0.4472135954999579*us9^2;
Fs2= us1*us2 + 0.8944271909999159*us2*us3 + 0.8783100656536799*us3*us4 + us5*us6 + 0.8944271909999159*us6*us7 + us8*us9;
Fs1= 0.5*us1^2 + 0.5*us2^2 + 0.5*us3^2 + 0.5*us4^2 + 0.5*us5^2 + 0.5*us6^2 + 0.5*us7^2 + 0.5*us8^2 + 0.5*us9^2 + 0.5*us10^2;
Fw10= uw1*uw10 + 0.8783100656536799*uw5*uw8 + 0.8783100656536799*uw6*uw9 + 0.5962847939999439*uw8*uw10;
Fw9= uw1*uw9 + uw2*uw8 + 0.8944271909999159*uw5*uw6 + 0.8944271909999159*uw3*uw9 + 0.8*uw6*uw7 + 0.8783100656536799*uw6*uw10 + 0.6388765649999399*uw8*uw9;
Fw8= uw1*uw8 + uw2*uw9 + 0.8783100656536799*uw5*uw10 + 0.4472135954999579*uw5^2 + 0.4472135954999579*uw6^2 + 0.4472135954999579*uw7^2 + 0.31943828249997*uw8^2 + 0.31943828249997*uw9^2 + 0.298142396999972*uw10^2;
Fw7= uw1*uw7 + 0.8944271909999159*uw2*uw6 + uw3*uw5 + 0.6388765649999399*uw3*uw7 + 0.8783100656536799*uw4*uw6 + 0.8*uw6*uw9 + 0.8944271909999159*uw7*uw8;
Fw6= uw1*uw6 + uw2*uw5 + 0.8944271909999159*uw2*uw7 + 0.8944271909999159*uw3*uw6 + 0.8783100656536799*uw4*uw7 + 0.8944271909999159*uw5*uw9 + 0.8944271909999159*uw6*uw8 + 0.8*uw7*uw9 + 0.8783100656536799*uw9*uw10;
Fw5= uw1*uw5 + uw2*uw6 + uw3*uw7 + 0.8944271909999159*uw5*uw8 + 0.8944271909999159*uw6*uw9 + 0.8783100656536799*uw8*uw10;
Fw4= uw1*uw4 + 0.8783100656536799*uw2*uw3 + 0.5962847939999439*uw3*uw4 + 0.8783100656536799*uw6*uw7;
Fw3= uw1*uw3 + 0.8783100656536799*uw2*uw4 + uw5*uw7 + 0.4472135954999579*uw2^2 + 0.31943828249997*uw3^2 + 0.298142396999972*uw4^2 + 0.4472135954999579*uw6^2 + 0.31943828249997*uw7^2 + 0.4472135954999579*uw9^2;
Fw2= uw1*uw2 + 0.8944271909999159*uw2*uw3 + 0.8783100656536799*uw3*uw4 + uw5*uw6 + 0.8944271909999159*uw6*uw7 + uw8*uw9;
Fw1= 0.5*uw1^2 + 0.5*uw2^2 + 0.5*uw3^2 + 0.5*uw4^2 + 0.5*uw5^2 + 0.5*uw6^2 + 0.5*uw7^2 + 0.5*uw8^2 + 0.5*uw9^2 + 0.5*uw10^2;
Jac_east_other_temp_pre(10,10) = 2.0*dF1 + 1.192569587999888*dF3;
Jac_east_other_temp_pre(10,9) = - 3.04255531702266*dF2 - 2.065591117977289*dF4;
Jac_east_other_temp_pre(10,8) = 1.75662013130736*dF2 + 1.192569587999888*dF4;
Jac_east_other_temp_pre(10,7) = 3.927922024247863*dF3;
Jac_east_other_temp_pre(10,6) = -3.04255531702266*dF3;
Jac_east_other_temp_pre(10,5) = 1.75662013130736*dF3;
Jac_east_other_temp_pre(10,4) = -5.291502622129181*dF4;
Jac_east_other_temp_pre(10,3) = 4.472135954999579*dF4;
Jac_east_other_temp_pre(10,2) = -3.464101615137755*dF4;
Jac_east_other_temp_pre(10,1) = 2.0*dF4;
Jac_east_other_temp_pre(9,10) = 3.04255531702266*dF2 + 2.065591117977289*dF4;
Jac_east_other_temp_pre(9,9) = - 6.0*dF1 - 3.833259389999639*dF3;
Jac_east_other_temp_pre(9,8) = 3.464101615137755*dF1 + 2.213133340689953*dF3;
Jac_east_other_temp_pre(9,7) = 6.928203230275509*dF2 + 6.80336051416609*dF4;
Jac_east_other_temp_pre(9,6) = - 5.366563145999495*dF2 - 5.269860393922079*dF4;
Jac_east_other_temp_pre(9,5) = 3.098386676965934*dF2 + 3.04255531702266*dF4;
Jac_east_other_temp_pre(9,4) = -9.16515138991168*dF3;
Jac_east_other_temp_pre(9,3) = 7.745966692414834*dF3;
Jac_east_other_temp_pre(9,2) = -6.0*dF3;
Jac_east_other_temp_pre(9,1) = 3.464101615137755*dF3;
Jac_east_other_temp_pre(8,10) = 1.75662013130736*dF2 + 1.192569587999888*dF4;
Jac_east_other_temp_pre(8,9) = - 3.464101615137755*dF1 - 2.213133340689953*dF3;
Jac_east_other_temp_pre(8,8) = 2.0*dF1 + 1.27775312999988*dF3;
Jac_east_other_temp_pre(8,7) = 4.0*dF2 + 3.927922024247863*dF4;
Jac_east_other_temp_pre(8,6) = - 3.098386676965934*dF2 - 3.04255531702266*dF4;
Jac_east_other_temp_pre(8,5) = 1.788854381999832*dF2 + 1.75662013130736*dF4;
Jac_east_other_temp_pre(8,4) = -5.291502622129181*dF3;
Jac_east_other_temp_pre(8,3) = 4.472135954999579*dF3;
Jac_east_other_temp_pre(8,2) = -3.464101615137755*dF3;
Jac_east_other_temp_pre(8,1) = 2.0*dF3;
Jac_east_other_temp_pre(7,10) = 3.927922024247863*dF3;
Jac_east_other_temp_pre(7,9) = - 6.928203230275509*dF2 - 6.80336051416609*dF4;
Jac_east_other_temp_pre(7,8) = 4.0*dF2 + 3.927922024247863*dF4;
Jac_east_other_temp_pre(7,7) = 10.0*dF1 + 8.944271909999159*dF3;
Jac_east_other_temp_pre(7,6) = - 7.745966692414834*dF1 - 6.928203230275509*dF3;
Jac_east_other_temp_pre(7,5) = 4.472135954999579*dF1 + 4.0*dF3;
Jac_east_other_temp_pre(7,4) = -11.83215956619923*dF2;
Jac_east_other_temp_pre(7,3) = 10.0*dF2;
Jac_east_other_temp_pre(7,2) = -7.745966692414834*dF2;
Jac_east_other_temp_pre(7,1) = 4.472135954999579*dF2;
Jac_east_other_temp_pre(6,10) = 3.04255531702266*dF3;
Jac_east_other_temp_pre(6,9) = - 5.366563145999495*dF2 - 5.269860393922079*dF4;
Jac_east_other_temp_pre(6,8) = 3.098386676965934*dF2 + 3.04255531702266*dF4;
Jac_east_other_temp_pre(6,7) = 7.745966692414834*dF1 + 6.928203230275509*dF3;
Jac_east_other_temp_pre(6,6) = - 6.0*dF1 - 5.366563145999495*dF3;
Jac_east_other_temp_pre(6,5) = 3.464101615137755*dF1 + 3.098386676965934*dF3;
Jac_east_other_temp_pre(6,4) = -9.16515138991168*dF2;
Jac_east_other_temp_pre(6,3) = 7.745966692414834*dF2;
Jac_east_other_temp_pre(6,2) = -6.0*dF2;
Jac_east_other_temp_pre(6,1) = 3.464101615137755*dF2;
Jac_east_other_temp_pre(5,10) = 1.75662013130736*dF3;
Jac_east_other_temp_pre(5,9) = - 3.098386676965934*dF2 - 3.04255531702266*dF4;
Jac_east_other_temp_pre(5,8) = 1.788854381999832*dF2 + 1.75662013130736*dF4;
Jac_east_other_temp_pre(5,7) = 4.472135954999579*dF1 + 4.0*dF3;
Jac_east_other_temp_pre(5,6) = - 3.464101615137755*dF1 - 3.098386676965934*dF3;
Jac_east_other_temp_pre(5,5) = 2.0*dF1 + 1.788854381999832*dF3;
Jac_east_other_temp_pre(5,4) = -5.291502622129181*dF2;
Jac_east_other_temp_pre(5,3) = 4.472135954999579*dF2;
Jac_east_other_temp_pre(5,2) = -3.464101615137755*dF2;
Jac_east_other_temp_pre(5,1) = 2.0*dF2;
Jac_east_other_temp_pre(4,10) = 5.291502622129181*dF4;
Jac_east_other_temp_pre(4,9) = -9.16515138991168*dF3;
Jac_east_other_temp_pre(4,8) = 5.291502622129181*dF3;
Jac_east_other_temp_pre(4,7) = 11.83215956619923*dF2;
Jac_east_other_temp_pre(4,6) = -9.16515138991168*dF2;
Jac_east_other_temp_pre(4,5) = 5.291502622129181*dF2;
Jac_east_other_temp_pre(4,4) = -14.0*dF1;
Jac_east_other_temp_pre(4,3) = 11.83215956619923*dF1;
Jac_east_other_temp_pre(4,2) = -9.16515138991168*dF1;
Jac_east_other_temp_pre(4,1) = 5.291502622129181*dF1;
Jac_east_other_temp_pre(3,10) = 4.472135954999579*dF4;
Jac_east_other_temp_pre(3,9) = -7.745966692414834*dF3;
Jac_east_other_temp_pre(3,8) = 4.472135954999579*dF3;
Jac_east_other_temp_pre(3,7) = 10.0*dF2;
Jac_east_other_temp_pre(3,6) = -7.745966692414834*dF2;
Jac_east_other_temp_pre(3,5) = 4.472135954999579*dF2;
Jac_east_other_temp_pre(3,4) = -11.83215956619923*dF1;
Jac_east_other_temp_pre(3,3) = 10.0*dF1;
Jac_east_other_temp_pre(3,2) = -7.745966692414834*dF1;
Jac_east_other_temp_pre(3,1) = 4.472135954999579*dF1;
Jac_east_other_temp_pre(2,10) = 3.464101615137755*dF4;
Jac_east_other_temp_pre(2,9) = -6.0*dF3;
Jac_east_other_temp_pre(2,8) = 3.464101615137755*dF3;
Jac_east_other_temp_pre(2,7) = 7.745966692414834*dF2;
Jac_east_other_temp_pre(2,6) = -6.0*dF2;
Jac_east_other_temp_pre(2,5) = 3.464101615137755*dF2;
Jac_east_other_temp_pre(2,4) = -9.16515138991168*dF1;
Jac_east_other_temp_pre(2,3) = 7.745966692414834*dF1;
Jac_east_other_temp_pre(2,2) = -6.0*dF1;
Jac_east_other_temp_pre(2,1) = 3.464101615137755*dF1;
Jac_east_other_temp_pre(1,10) = 2.0*dF4;
Jac_east_other_temp_pre(1,9) = -3.464101615137755*dF3;
Jac_east_other_temp_pre(1,8) = 2.0*dF3;
Jac_east_other_temp_pre(1,7) = 4.472135954999579*dF2;
Jac_east_other_temp_pre(1,6) = -3.464101615137755*dF2;
Jac_east_other_temp_pre(1,5) = 2.0*dF2;
Jac_east_other_temp_pre(1,4) = -5.291502622129181*dF1;
Jac_east_other_temp_pre(1,3) = 4.472135954999579*dF1;
Jac_east_other_temp_pre(1,2) = -3.464101615137755*dF1;
Jac_east_other_temp_pre(1,1) = 2.0*dF1;
Jac_east_other_temp = nuv1*Jac_east_other_temp_pre;
