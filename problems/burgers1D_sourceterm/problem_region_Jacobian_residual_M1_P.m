function [Jacobian,residual] = problem_region_Jacobian_residual_M1_P(q,q_past,auxiliary,nuv1) 
Upsi_1_1 = q(1,1,1);
Upsi_2_1 = q(1,2,1);
Upsi_3_1 = q(1,3,1);
Upsi_past_1_1 = q_past(1,1,1);
Upsi_past_2_1 = q_past(1,2,1);
Upsi_past_3_1 = q_past(1,3,1);
Uphi1_east_1 = Upsi_1_1;
Uphi2_east_1 = Upsi_2_1;
Uphi3_east_1 = Upsi_3_1;
Uphi1_west_1 = Upsi_1_1;
Uphi2_west_1 = Upsi_2_1;
Uphi3_west_1 = Upsi_3_1;
lambda_sample_12_1 = max(abs(Uphi1_east_1),abs(Uphi2_west_1));
lambda_sample_23_1 = max(abs(Uphi2_east_1),abs(Uphi3_west_1));
lambda_12_1 = lambda_sample_12_1_1;
lambda_23_1 = lambda_sample_23_1_1;
residual = zeros(3,1);
residual(3,1) = 2.0*Upsi_3_1 - 2.0*Upsi_past_3_1 + nuv1*(Uphi3_west_1*lambda_23_1 - 1.0*Uphi2_east_1*lambda_23_1 - 0.5*Uphi2_east_1^2 + Uphi3_east_1^2 - 0.5*Uphi3_west_1^2);
residual(2,1) = 2.0*Upsi_2_1 - 2.0*Upsi_past_2_1 + nuv1*(Uphi2_west_1*lambda_12_1 - 1.0*Uphi1_east_1*lambda_12_1 + Uphi2_east_1*lambda_23_1 - 1.0*Uphi3_west_1*lambda_23_1 - 0.5*Uphi1_east_1^2 + 0.5*Uphi2_east_1^2 - 0.5*Uphi2_west_1^2 + 0.5*Uphi3_west_1^2);
residual(1,1) = 2.0*Upsi_1_1 - 2.0*Upsi_past_1_1 + nuv1*(Uphi1_east_1*lambda_12_1 - 1.0*Uphi2_west_1*lambda_12_1 + 0.5*Uphi1_east_1^2 - 1.0*Uphi1_west_1^2 + 0.5*Uphi2_west_1^2);
Jacobian = zeros(3,3);
Jacobian(3,3) = 2.0 + nuv1*(2.0*Uphi3_east_1 - 1.0*Uphi3_west_1 + lambda_23_1);
Jacobian(3,2) =  + nuv1*(- 1.0*Uphi2_east_1 - 1.0*lambda_23_1);
Jacobian(2,3) =  + nuv1*(Uphi3_west_1 - 1.0*lambda_23_1);
Jacobian(2,2) = 2.0 + nuv1*(Uphi2_east_1 - 1.0*Uphi2_west_1 + lambda_12_1 + lambda_23_1);
Jacobian(2,1) =  + nuv1*(- 1.0*Uphi1_east_1 - 1.0*lambda_12_1);
Jacobian(1,2) =  + nuv1*(Uphi2_west_1 - 1.0*lambda_12_1);
Jacobian(1,1) = 2.0 + nuv1*(Uphi1_east_1 - 2.0*Uphi1_west_1 + lambda_12_1);
