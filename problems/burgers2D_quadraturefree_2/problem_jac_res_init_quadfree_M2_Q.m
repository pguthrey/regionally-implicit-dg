function [Jacobian,residual] = problem_jac_res_init_quadfree_M2_Q(q,q_past,nuv1,nuv2) 
Upsi_1_8 = q(8);
Upsi_1_7 = q(7);
Upsi_1_6 = q(6);
Upsi_1_5 = q(5);
Upsi_1_4 = q(4);
Upsi_1_3 = q(3);
Upsi_1_2 = q(2);
Upsi_1_1 = q(1);
Upsi_past_1_8 = q_past(8,1,1);
Upsi_past_1_7 = q_past(7,1,1);
Upsi_past_1_6 = q_past(6,1,1);
Upsi_past_1_5 = q_past(5,1,1);
Upsi_past_1_4 = q_past(4,1,1);
Upsi_past_1_3 = q_past(3,1,1);
Upsi_past_1_2 = q_past(2,1,1);
Upsi_past_1_1 = q_past(1,1,1);
residual = zeros(8,1);
Jacobian = zeros(8,8);
residual(8,1) = 12.0*Upsi_1_8 - 6.92820323027550917*Upsi_1_4 + 6.92820323027550917*Upsi_past_1_4 + 12.0*Upsi_past_1_8;
residual(8,1) = residual(8,1) +  nuv1*(- 13.8564064605510183*Upsi_1_1*Upsi_1_6 - 13.8564064605510183*Upsi_1_2*Upsi_1_5 - 13.8564064605510183*Upsi_1_3*Upsi_1_8 - 13.8564064605510183*Upsi_1_4*Upsi_1_7);
residual(8,1) = residual(8,1) +  nuv2*(- 13.8564064605510183*Upsi_1_1*Upsi_1_7 - 13.8564064605510183*Upsi_1_3*Upsi_1_5 - 13.8564064605510183*Upsi_1_2*Upsi_1_8 - 13.8564064605510183*Upsi_1_4*Upsi_1_6);
Jacobian(8,8) = 12.0 + nuv1*(-13.8564064605510183*Upsi_1_3) + nuv2*(-13.8564064605510183*Upsi_1_2);
Jacobian(8,7) =   + nuv1*(-13.8564064605510183*Upsi_1_4) + nuv2*(-13.8564064605510183*Upsi_1_1);
Jacobian(8,6) =   + nuv1*(-13.8564064605510183*Upsi_1_1) + nuv2*(-13.8564064605510183*Upsi_1_4);
Jacobian(8,5) =   + nuv1*(-13.8564064605510183*Upsi_1_2) + nuv2*(-13.8564064605510183*Upsi_1_3);
Jacobian(8,4) = -6.92820323027550917 + nuv1*(-13.8564064605510183*Upsi_1_7) + nuv2*(-13.8564064605510183*Upsi_1_6);
Jacobian(8,3) =   + nuv1*(-13.8564064605510183*Upsi_1_8) + nuv2*(-13.8564064605510183*Upsi_1_5);
Jacobian(8,2) =   + nuv1*(-13.8564064605510183*Upsi_1_5) + nuv2*(-13.8564064605510183*Upsi_1_8);
Jacobian(8,1) =   + nuv1*(-13.8564064605510183*Upsi_1_6) + nuv2*(-13.8564064605510183*Upsi_1_7);
residual(7,1) = 12.0*Upsi_1_7 - 6.92820323027550917*Upsi_1_3 + 6.92820323027550917*Upsi_past_1_3 + 12.0*Upsi_past_1_7;
residual(7,1) = residual(7,1) +  nuv1*(- 13.8564064605510183*Upsi_1_1*Upsi_1_5 - 13.8564064605510183*Upsi_1_2*Upsi_1_6 - 13.8564064605510183*Upsi_1_3*Upsi_1_7 - 13.8564064605510183*Upsi_1_4*Upsi_1_8);
Jacobian(7,8) =   + nuv1*(-13.8564064605510183*Upsi_1_4) ;
Jacobian(7,7) = 12.0 + nuv1*(-13.8564064605510183*Upsi_1_3) ;
Jacobian(7,6) =   + nuv1*(-13.8564064605510183*Upsi_1_2) ;
Jacobian(7,5) =   + nuv1*(-13.8564064605510183*Upsi_1_1) ;
Jacobian(7,4) =   + nuv1*(-13.8564064605510183*Upsi_1_8) ;
Jacobian(7,3) = -6.92820323027550917 + nuv1*(-13.8564064605510183*Upsi_1_7) ;
Jacobian(7,2) =   + nuv1*(-13.8564064605510183*Upsi_1_6) ;
Jacobian(7,1) =   + nuv1*(-13.8564064605510183*Upsi_1_5) ;
residual(6,1) = 12.0*Upsi_1_6 - 6.92820323027550917*Upsi_1_2 + 6.92820323027550917*Upsi_past_1_2 + 12.0*Upsi_past_1_6;
residual(6,1) = residual(6,1) +  nuv2*(- 13.8564064605510183*Upsi_1_1*Upsi_1_5 - 13.8564064605510183*Upsi_1_2*Upsi_1_6 - 13.8564064605510183*Upsi_1_3*Upsi_1_7 - 13.8564064605510183*Upsi_1_4*Upsi_1_8);
Jacobian(6,8) =    + nuv2*(-13.8564064605510183*Upsi_1_4);
Jacobian(6,7) =    + nuv2*(-13.8564064605510183*Upsi_1_3);
Jacobian(6,6) = 12.0  + nuv2*(-13.8564064605510183*Upsi_1_2);
Jacobian(6,5) =    + nuv2*(-13.8564064605510183*Upsi_1_1);
Jacobian(6,4) =    + nuv2*(-13.8564064605510183*Upsi_1_8);
Jacobian(6,3) =    + nuv2*(-13.8564064605510183*Upsi_1_7);
Jacobian(6,2) = -6.92820323027550917  + nuv2*(-13.8564064605510183*Upsi_1_6);
Jacobian(6,1) =    + nuv2*(-13.8564064605510183*Upsi_1_5);
residual(5,1) = 12.0*Upsi_1_5 - 6.92820323027550917*Upsi_1_1 + 6.92820323027550917*Upsi_past_1_1 + 12.0*Upsi_past_1_5;
Jacobian(5,5) = 12.0  ;
Jacobian(5,1) = -6.92820323027550917  ;
residual(4,1) = 4.0*Upsi_1_4 + 6.92820323027550917*Upsi_1_8 - 4.0*Upsi_past_1_4 - 6.92820323027550917*Upsi_past_1_8;
residual(4,1) = residual(4,1) +  nuv1*(- 13.8564064605510183*Upsi_1_1*Upsi_1_2 - 13.8564064605510183*Upsi_1_3*Upsi_1_4 - 13.8564064605510183*Upsi_1_5*Upsi_1_6 - 13.8564064605510183*Upsi_1_7*Upsi_1_8);
residual(4,1) = residual(4,1) +  nuv2*(- 13.8564064605510183*Upsi_1_1*Upsi_1_3 - 13.8564064605510183*Upsi_1_2*Upsi_1_4 - 13.8564064605510183*Upsi_1_5*Upsi_1_7 - 13.8564064605510183*Upsi_1_6*Upsi_1_8);
Jacobian(4,8) = 6.92820323027550917 + nuv1*(-13.8564064605510183*Upsi_1_7) + nuv2*(-13.8564064605510183*Upsi_1_6);
Jacobian(4,7) =   + nuv1*(-13.8564064605510183*Upsi_1_8) + nuv2*(-13.8564064605510183*Upsi_1_5);
Jacobian(4,6) =   + nuv1*(-13.8564064605510183*Upsi_1_5) + nuv2*(-13.8564064605510183*Upsi_1_8);
Jacobian(4,5) =   + nuv1*(-13.8564064605510183*Upsi_1_6) + nuv2*(-13.8564064605510183*Upsi_1_7);
Jacobian(4,4) = 4.0 + nuv1*(-13.8564064605510183*Upsi_1_3) + nuv2*(-13.8564064605510183*Upsi_1_2);
Jacobian(4,3) =   + nuv1*(-13.8564064605510183*Upsi_1_4) + nuv2*(-13.8564064605510183*Upsi_1_1);
Jacobian(4,2) =   + nuv1*(-13.8564064605510183*Upsi_1_1) + nuv2*(-13.8564064605510183*Upsi_1_4);
Jacobian(4,1) =   + nuv1*(-13.8564064605510183*Upsi_1_2) + nuv2*(-13.8564064605510183*Upsi_1_3);
residual(3,1) = 4.0*Upsi_1_3 + 6.92820323027550917*Upsi_1_7 - 4.0*Upsi_past_1_3 - 6.92820323027550917*Upsi_past_1_7;
residual(3,1) = residual(3,1) +  nuv1*(- 6.92820323027550917*Upsi_1_1^2 - 6.92820323027550917*Upsi_1_2^2 - 6.92820323027550917*Upsi_1_3^2 - 6.92820323027550917*Upsi_1_4^2 - 6.92820323027550917*Upsi_1_5^2 - 6.92820323027550917*Upsi_1_6^2 - 6.92820323027550917*Upsi_1_7^2 - 6.92820323027550917*Upsi_1_8^2);
Jacobian(3,8) =   + nuv1*(-13.8564064605510183*Upsi_1_8) ;
Jacobian(3,7) = 6.92820323027550917 + nuv1*(-13.8564064605510183*Upsi_1_7) ;
Jacobian(3,6) =   + nuv1*(-13.8564064605510183*Upsi_1_6) ;
Jacobian(3,5) =   + nuv1*(-13.8564064605510183*Upsi_1_5) ;
Jacobian(3,4) =   + nuv1*(-13.8564064605510183*Upsi_1_4) ;
Jacobian(3,3) = 4.0 + nuv1*(-13.8564064605510183*Upsi_1_3) ;
Jacobian(3,2) =   + nuv1*(-13.8564064605510183*Upsi_1_2) ;
Jacobian(3,1) =   + nuv1*(-13.8564064605510183*Upsi_1_1) ;
residual(2,1) = 4.0*Upsi_1_2 + 6.92820323027550917*Upsi_1_6 - 4.0*Upsi_past_1_2 - 6.92820323027550917*Upsi_past_1_6;
residual(2,1) = residual(2,1) +  nuv2*(- 6.92820323027550917*Upsi_1_1^2 - 6.92820323027550917*Upsi_1_2^2 - 6.92820323027550917*Upsi_1_3^2 - 6.92820323027550917*Upsi_1_4^2 - 6.92820323027550917*Upsi_1_5^2 - 6.92820323027550917*Upsi_1_6^2 - 6.92820323027550917*Upsi_1_7^2 - 6.92820323027550917*Upsi_1_8^2);
Jacobian(2,8) =    + nuv2*(-13.8564064605510183*Upsi_1_8);
Jacobian(2,7) =    + nuv2*(-13.8564064605510183*Upsi_1_7);
Jacobian(2,6) = 6.92820323027550917  + nuv2*(-13.8564064605510183*Upsi_1_6);
Jacobian(2,5) =    + nuv2*(-13.8564064605510183*Upsi_1_5);
Jacobian(2,4) =    + nuv2*(-13.8564064605510183*Upsi_1_4);
Jacobian(2,3) =    + nuv2*(-13.8564064605510183*Upsi_1_3);
Jacobian(2,2) = 4.0  + nuv2*(-13.8564064605510183*Upsi_1_2);
Jacobian(2,1) =    + nuv2*(-13.8564064605510183*Upsi_1_1);
residual(1,1) = 4.0*Upsi_1_1 + 6.92820323027550917*Upsi_1_5 - 4.0*Upsi_past_1_1 - 6.92820323027550917*Upsi_past_1_5;
Jacobian(1,5) = 6.92820323027550917  ;
Jacobian(1,1) = 4.0  ;
